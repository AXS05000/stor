{% load static %}

<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="keywords" content="Bootstrap, Landing page, Template, Registration, Landing">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="author" content="Grayrids">
    <title>GO2B BI</title>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="{% static 'assets_2/css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'assets_2/css/line-icons.css' %}">
    <link rel="stylesheet" href="{% static 'assets_2/css/owl.carousel.css' %}">
    <link rel="stylesheet" href="{% static 'assets_2/css/owl.theme.css' %}">
    <link rel="stylesheet" href="{% static 'assets_2/css/nivo-lightbox.css' %}">
    <link rel="stylesheet" href="{% static 'assets_2/css/magnific-popup.css' %}">
    <link rel="stylesheet" href="{% static 'assets_2/css/animate.css' %}">
    <link rel="stylesheet" href="{% static 'assets_2/css/color-switcher.css' %}">
    <link rel="stylesheet" href="{% static 'assets_2/css/menu_sideslide.css' %}">
    <link rel="stylesheet" href="{% static 'assets_2/css/main.css' %}"> 
    <link rel="stylesheet" href="{% static 'assets_2/css/responsive.css' %}">
    <link id="pagestyle" href="{% static 'css/upload_files.css' %}" rel="stylesheet" />
    <link rel="icon" type="image/png" href="{% static 'assets/img/go2b-bi.png' %}">
  </head>
  
  <body>
    <!-- Header Section Start -->
    <header id="slider-area">  
      <nav class="navbar navbar-expand-md fixed-top scrolling-navbar bg-white">
        <div class="container">  
          <a class="navbar-brand" href="{% url 'index' %}"><img class="brand-logo" src="{% static 'assets/img/go2b-bi.png' %}" alt="" style="max-height: 25px;">  GO2B-BI</a>
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
            <i class="lni-menu"></i>
          </button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav mr-auto w-100 justify-content-end">
              {% if user.is_superuser %}
              <li class="nav-item">
                <a class="nav-link page-scroll" href="{% url 'index' %}">Home</a>
              </li>
              <li class="nav-item">
                <a class="nav-link page-scroll" href="#services">Serviços</a>
              </li>
              <li class="nav-item">
                <a class="nav-link page-scroll" href="#portfolios">Trabalhos</a>
              </li>
              <li class="nav-item">
                <a class="nav-link page-scroll" href="#team">Equipe</a>
              </li>
              <li class="nav-item dropdown">
                <a class="nav-link page-scroll nav-link-ded dropdown-toggle" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Notas</a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <a class="nav-link" href="{% url 'gerar-csv' %}">Notas Fiscais</a>
                  <a class="nav-link" href="{% url 'notasficais' %}">Notas Portal</a>
                  <a class="nav-link" href="{% url 'notafiscal' %}">Emitir OS</a>
                  <div class="dropdown-divider"></div>
                  <a class="nav-link" href="{% url 'cnpj' %}">Cadastrar CNPJ</a>
                  <a class="nav-link" href="{% url 'form_valor_hora' %}">Cadastrar Valor Hora</a>
                  <a class="nav-link" href="{% url 'importar_basecnpj' %}">Importar CNPJ</a>
                  <a class="nav-link" href="{% url 'importar_notas_' %}">Importar Notas</a>
              </div>
              </li>                             
              <li class="nav-item dropdown">
                <a class="nav-link page-scroll nav-link-ded dropdown-toggle" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Admissão</a>
                  <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                      <a class="nav-link" href="{% url 'admissao' %}">Form Admissão</a>
                      <a class="nav-link" href="{% url 'search_collaborator' %}">Painel RH</a>
                      <div class="dropdown-divider"></div>
                      {% comment %} <a class="dropdown-item" href="#">Tes</a> {% endcomment %}
              </li>
              <li class="nav-item dropdown">
                <a class="nav-link nav-link-ded dropdown-toggle" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Importações</a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    <a class="nav-link" href="{% url 'upload_template' %}">Importar Word</a>
                    <a class="nav-link" href="{% url 'upload_excel' %}">Importar Mala</a>
                    <a class="nav-link" href="{% url 'upload_excel_folha' %}">Importar Folha</a>
                    <a class="nav-link" href="{% url 'upload_excel_beneficio' %}">Importar Beneficio</a>
                    <a class="nav-link" href="{% url 'importar_basecnpj' %}">Importar CNPJ Notas</a>
                    <a class="nav-link" href="{% url 'importar_notas_' %}">Importar Notas</a>
                    {% comment %} <div class="dropdown-divider"></div> {% endcomment %}
                    {% comment %} <a class="dropdown-item" href="#">Tes</a> {% endcomment %}
                </div>
              </li>
              {% else %}
              <li class="nav-item">
                <a class="nav-link page-scroll" href="{% url 'index' %}">Home</a>
              </li>
              <li class="nav-item dropdown">
                <a class="nav-link page-scroll nav-link-ded dropdown-toggle" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Notas</a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <a class="nav-link" href="{% url 'gerar-csv' %}">Notas Fiscais</a>
                  <a class="nav-link" href="{% url 'notasficais' %}">Notas Portal</a>
                  <a class="nav-link" href="{% url 'notafiscal' %}">Emitir OS</a>
                  <div class="dropdown-divider"></div>
                  <a class="nav-link" href="{% url 'cnpj' %}">Cadastrar CNPJ</a>
                  <a class="nav-link" href="{% url 'form_valor_hora' %}">Cadastrar Valor Hora</a>
                  <a class="nav-link" href="{% url 'importar_basecnpj' %}">Importar CNPJ</a>
                  <a class="nav-link" href="{% url 'importar_notas_' %}">Importar Notas</a>
              </div>
              </li> 
              {% endif %} 
              {% if user.is_anonymous %}
              {% else %}
              <li class="nav-item">
                <a class="nav-link page-scroll" href="{% url 'logout' %}">Sair</a>
              </li>
              {% endif %}  

            </ul>              
          </div>
        </div>
      </nav> 


    </header>
    <!-- Header Section End --> 

    <div class="form-container form-center container d-flex justify-content-center align-items-center">
    <!-- Features Section Start -->
    <section id="template" class="section">
      <div class="container">
        <div class="section-header">          
          <h2 class="section-title">IMPORTE SUA PLANILHA:</h2>
          <span>CNPJ NOTAS</span>
        </div>
        <div class="row">


          <div class="modal22">
            <form method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="modal22-header">
                    <div class="modal22-logo">
                        <span class="logo-circle">
                            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="512" height="419.116" viewBox="0 0 512 419.116">
                                <defs>
                                    <clipPath id="clip-folder-new">
                                        <rect width="512" height="419.116" />
                                    </clipPath>
                                </defs>
                                <g id="folder-new" clip-path="url(#clip-folder-new)">
                                    <path id="Union_1" data-name="Union 1" d="M16.991,419.116A16.989,16.989,0,0,1,0,402.125V16.991A16.989,16.989,0,0,1,16.991,0H146.124a17,17,0,0,1,10.342,3.513L227.217,57.77H437.805A16.989,16.989,0,0,1,454.8,74.761v53.244h40.213A16.992,16.992,0,0,1,511.6,148.657L454.966,405.222a17,17,0,0,1-16.6,13.332H410.053v.562ZM63.06,384.573H424.722L473.86,161.988H112.2Z" fill="var(--c-action-primary)" stroke="" stroke-width="1" />
                                </g>
                            </svg>
                        </span>
                    </div>
                    <span class="btn-close">
                        <svg xmlns="http://www.w3.org/2000/svg" style="display: none"width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z" fill="var(--c-text-secondary)"/></svg>
                    </span>
                </div>
                <div class="modal22-body">
                    <h2 class="modal22-title" style="font-size: 1.6rem;">Envie Sua Planilha</h2>
                    <p class="modal22-description">Anexe o arquivo abaixo</p>
                    <div id="uploadArea" class="upload-area">
                        <input type="file" id="fileInput" name="arquivo">
                        <span class="upload-area-icon">
                            <svg id="uploadSvg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="340.531" height="419.116" viewBox="0 0 340.531 419.116">
                                <g id="files-new" clip-path="url(#clip-files-new)">
                                  <path id="Union_2" data-name="Union 2" d="M-2904.708-8.885A39.292,39.292,0,0,1-2944-48.177V-388.708A39.292,39.292,0,0,1-2904.708-428h209.558a13.1,13.1,0,0,1,9.3,3.8l78.584,78.584a13.1,13.1,0,0,1,3.8,9.3V-48.177a39.292,39.292,0,0,1-39.292,39.292Zm-13.1-379.823V-48.177a13.1,13.1,0,0,0,13.1,13.1h261.947a13.1,13.1,0,0,0,13.1-13.1V-323.221h-52.39a26.2,26.2,0,0,1-26.194-26.195v-52.39h-196.46A13.1,13.1,0,0,0-2917.805-388.708Zm146.5,241.621a14.269,14.269,0,0,1-7.883-12.758v-19.113h-68.841c-7.869,0-7.87-47.619,0-47.619h68.842v-18.8a14.271,14.271,0,0,1,7.882-12.758,14.239,14.239,0,0,1,14.925,1.354l57.019,42.764c.242.185.328.485.555.671a13.9,13.9,0,0,1,2.751,3.292,14.57,14.57,0,0,1,.984,1.454,14.114,14.114,0,0,1,1.411,5.987,14.006,14.006,0,0,1-1.411,5.973,14.653,14.653,0,0,1-.984,1.468,13.9,13.9,0,0,1-2.751,3.293c-.228.2-.313.485-.555.671l-57.019,42.764a14.26,14.26,0,0,1-8.558,2.847A14.326,14.326,0,0,1-2771.3-147.087Z" transform="translate(2944 428)" fill="var(--c-action-primary)"/>
                                </g>
                              </svg>
                        </span>
                        <span class="upload-area-title">Arraste o arquivo aqui para carregar.</span>
                        <span class="upload-area-description">
                            Ou você pode selecionar um arquivo<br/><strong class="clique-aqui">clicando aqui</strong>
                        </span>
                    </div>
                </div>
                <div class="modal22-footer">
                    <a class="login-button btn-secondary" href="{% url 'index' %}">Voltar</a>
                    <button class="btn-primary" type="submit">Enviar Arquivo</button>
                </div>
            </form>
        </div>

        </div>
      </div>
    </section>
    </div>
    <!-- Features Section End -->   















    
      <!-- Copyright Start  -->
      <div id="copyright">
        <div class="container">
          <div class="row">
            <div class="col-md-12">
              <div class="site-info float-left">
                <p>Crafted by <a href="http://uideck.com" rel="nofollow">UIdeck</a></p>
              </div>              
              <div class="float-right">  
                <ul class="nav nav-inline">
                  <li class="nav-item">
                    <a class="nav-link active" href="#">About Prime</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#">TOS</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#">Return Policy</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#">FAQ</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#">Contact</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Copyright End -->

    </footer>
    <!-- Footer Section End --> 

    <!-- Go To Top Link -->
    <a href="#" class="back-to-top">
      <i class="lni-arrow-up"></i>
    </a>

    <div id="loader">
      <div class="spinner">
        <div class="double-bounce1"></div>
        <div class="double-bounce2"></div>
      </div>
    </div>    

    <!-- jQuery first, then Tether, then Bootstrap JS. -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script>
        $(document).ready(function () {
            $('#id_cliente_gi').change(function () {
                let cliente_gi_id = $(this).val();
                $.get('/api/departamentos/?cliente_gi_id=' + cliente_gi_id, function (data) {
                    let select = $('#id_departamento');
                    select.empty();
                    select.append('<option value="" selected>---------</option>'); // Adicionado aqui
                    $.each(data, function (index, value) {
                        select.append('<option value="' + value.id + '">' + value.nome_departamento + '</option>');
                    });
                });
                $.get('/api/bases/?cliente_gi_id=' + cliente_gi_id, function (data) {
                    let select = $('#id_cargo');
                    select.empty();
                    select.append('<option value="" selected>---------</option>'); // Adicionado aqui
                    $.each(data, function (index, value) {
                        select.append('<option value="' + value.id + '">' + value.cargo + '</option>');
                    });
                });
            });
        });
    </script>
    <script>
        $(document).ready(function() {
            $('#id_departamento').change(function() {
                var departamento_id = $(this).val();
                $.getJSON('/api/turnos/?departamento_id=' + departamento_id, function(data) {
                    var select = $('#id_turno');
                    select.empty();
                    select.append('<option value="" selected>---------</option>'); // Adicionado aqui
                    $.each(data, function(index, value) {
                        select.append('<option value="' + value.id + '">' + value.nome + '</option>');
                    });
                });
            });
        });
    </script>
    <script src="{% static 'assets_2/js/jquery-min.js' %}"></script>
    <script src="{% static 'assets_2/js/popper.min.js' %}"></script>
    <script src="{% static 'assets_2/js/bootstrap.min.js' %}"></script>
    <script src="{% static 'assets_2/js/classie.js' %}"></script>
    <script src="{% static 'assets_2/js/color-switcher.js' %}"></script>
    <script src="{% static 'assets_2/js/jquery.mixitup.js' %}"></script>
    <script src="{% static 'assets_2/js/nivo-lightbox.js' %}"></script>
    <script src="{% static 'assets_2/js/owl.carousel.js' %}"></script>    
    <script src="{% static 'assets_2/js/jquery.stellar.min.js' %}"></script>    
    <script src="{% static 'assets_2/js/jquery.nav.js' %}"></script>    
    <script src="{% static 'assets_2/js/scrolling-nav.js' %}"></script>    
    <script src="{% static 'assets_2/js/jquery.easing.min.js' %}"></script>     
    <script src="{% static 'assets_2/js/wow.js' %}"></script> 
    <script src="{% static 'assets_2/js/jquery.vide.js' %}"></script>
    <script src="{% static 'assets_2/js/jquery.counterup.min.js' %}"></script>    
    <script src="{% static 'assets_2/js/jquery.magnific-popup.min.js' %}"></script>    
    <script src="{% static 'assets_2/js/waypoints.min.js' %}"></script>    
    <script src="{% static 'assets_2/js/form-validator.min.js' %}"></script>
    <script src="{% static 'assets_2/js/contact-form-script.js' %}"></script>   
    <script src="{% static 'assets_2/js/main.js' %}"></script>
    <script>
      window.STATIC_URL = "{% static '' %}";
    </script>
    <script>
      var uploadArea = document.getElementById('uploadArea');
      var fileInput = document.getElementById('fileInput');
  
      // Permitir que o usuário clique na área de upload para escolher um arquivo
      uploadArea.addEventListener('click', function() {
          fileInput.click();
      });
  
      // Impedir o comportamento padrão do navegador ao arrastar um arquivo para a janela
      uploadArea.addEventListener('dragover', function(event) {
          event.preventDefault();
      });
  
      // Adicionar o arquivo à entrada quando ele for solto na área de upload
      uploadArea.addEventListener('drop', function(event) {
          event.preventDefault();
          fileInput.files = event.dataTransfer.files;
          var event = new Event('change');
          fileInput.dispatchEvent(event);  // Disparar o evento 'change' manualmente
      });
  </script>
  <script>
      fileInput.addEventListener('change', function() {
          var fileName = '';
          if (this.files && this.files.length > 0) {
              fileName = this.files[0].name;
          }
          var uploadAreaTitle = document.querySelector('.upload-area-title');
          var uploadAreaDescription = document.querySelector('.upload-area-description');
          if (fileName) {
              uploadAreaTitle.textContent = '';
              uploadAreaDescription.textContent = fileName;
          } else {
              uploadAreaTitle.textContent = 'Arraste o(s) arquivo(s) aqui para carregar.';
              uploadAreaDescription.textContent = 'Alternativamente, você pode selecionar um arquivo clicando aqui';
          }
      });
  </script>
  
  </body>
</html>